{{>adminHeader}}
{{#> style}}
<style>
    @import url('https://fonts.googleapis.com/css2?family=Amaranth:ital@1&family=Hind+Siliguri&family=Montserrat:wght@500&family=Mukta:wght@700&family=Open+Sans:wght@700&family=Raleway:wght@500&family=Roboto:wght@700&display=swap');

    :root {
        --base-dark-color: #5C8EB5;
        --base-grey-color: #525252;
    }

    .menu-link[data-link="inventory"] {
        background-color: #26ABE2;
        color: #fff;
    }

    /* TABLE */
    table {
        border-collapse: collapse;
        margin: 2em 0;

        width: 100%;
        table-layout: fixed;
    }

    table caption {
        font-size: 1.5em;
        margin: .5em 0 .75em;
    }

    table tr {
        background-color: #ffffff;
        padding: .35em;
    }

    #warehouse-table-body tr:hover {
        background-color: rgb(250, 250, 250);
        cursor: pointer;
    }

    table th:nth-child(1) {
        border-radius: 6px 0 0 0
    }

    table th:last-child {
        border-radius: 0 6px 0 0
    }

    table th,
    table td {

        padding: 1em 10px;
        text-align: center;
    }


    table th {
        font-size: .85em;
        letter-spacing: .1em;
        text-transform: uppercase;
        background-color: #5C8EB5;
        color: #fff;
    }

    @media screen and (max-width: 600px) {
        table {
            border: 0;
        }

        table caption {
            font-size: 1.3em;
        }

        table thead {
            border: none;
            clip: rect(0 0 0 0);
            height: 1px;
            margin: -1px;
            overflow: hidden;
            padding: 0;
            position: absolute;
            width: 1px;
        }

        table tr {
            border-bottom: 3px solid #ddd;
            display: block;
            margin-bottom: .625em;
        }

        table td {
            border-bottom: 1px solid #ddd;
            display: block;
            font-size: .8em;
            text-align: right;
        }

        table td::before {
            /*
        * aria-label has no advantage, it won't be read inside a table
        content: attr(aria-label);
        */
            content: attr(data-label);
            float: left;
            font-weight: bold;
            text-transform: uppercase;
        }

        table td:last-child {
            border-bottom: 0;
        }
    }

    /* ============================================================================================================================= */


    .add-new-item-modal,
    .check-in-out-modal {
        position: absolute;
        width: calc(100vw - 16.5em);
        height: 100vh;
        top: 0;
        right: 0;
        background-color: #ffffff;
        z-index: 11;

    }

    @media (max-width:1200px) {

        .add-new-item-modal,
        .check-in-out-modal {
            width: 100vw;
            height: 100vh;
        }
    }

    @media (max-width:768px) {

        .add-new-item-modal,
        .check-in-out-modal {
            height: auto;
        }
    }

    .add-new-item-modal h3 {
        font-family: 'Montserrat', sans-serif;
        color: #353234;
    }

    .add-new-item-modal .product-img div {
        height: 200px;
        width: 200px;
        border-radius: 10px;
        color: #26ABE2;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background-color: #e1f6ff;
        border: 3px dotted #26ABE2;
        cursor: pointer;
    }

    .add-new-item-modal .product-img div.active {
        background-color: transparent !important;
        background-size: cover !important;
        border: none !important;
    }

    .add-new-item-modal .product-img div i {
        font-size: 30px;
    }

    .add-new-item-modal .product-img div p {
        font-size: 13px;
        font-weight: 600;
    }

    .new-design-button {
        background-color: transparent;
        border: 2px solid #cfcfcf;
        padding: 0.2em 0.7em;
        border-radius: 5px;
        font-weight: 500;
        font-size: 13px;
        color: var(--base-grey-color);
    }

    .new-design-button:hover {
        color: #000;
    }

    .top-header-filter .new-design-button.active {
        background-color: #26ABE2;
        color: #fff;
        border: 2px solid #26ABE2;
    }

    .stock-status-in {
        padding: 1px 5px;
        border-radius: 5px;
        border: 2px solid #3eb940;
        background-color: #d4f1d5;
        color: #3eb940;
    }

    .stock-status-out {
        border: 2px solid #d2382a;
        padding: 1px 5px;
        border-radius: 5px;
        background-color: rgb(255 234 232);
        color: #d2382a;
    }

    .reports-details-container {
        height: 3em;
        width: 100%;
        background-color: #fff;
        border-radius: 5px;
    }

    .reports-details-container .reports-details p {
        font-size: 11px;
        font-weight: bolder;
        color: var(--base-grey-color);
    }

    .input-icon-right {
        position: absolute;
        right: 8px;
        top: 4px;
        font-size: 22px;
    }
</style>
{{/style}}
{{#*inline "body"}}
<div class="container-fluid px-md-5 mt-3">
    <div class="row">
        <div class="col-12 py-1 d-flex justify-content-between" style="overflow:hidden;">
            <div class="top-header-filter">
                <span class="font-weight-bold me-2">Find </span>
                <span class="cursor-pointer user-select-none new-design-button active" data-filter="inventory"
                    onclick="filterProducts('inventory')">Inventory</span>
                <span class="cursor-pointer user-select-none new-design-button " data-filter="items"
                    onclick="filterProducts('items')">Products</span>
                <script>
                    function filterProducts(cmd) {
                        $('.top-header-filter .new-design-button').removeClass('active')
                        $(`.top-header-filter .new-design-button[data-filter="${cmd}"]`).addClass('active')
                        if (cmd == "items") {
                            getAllProducts()
                        } else if (cmd == "inventory") {
                            inventory()
                        }
                    }
                </script>
            </div>
            <div class="top-header-middle">
                <span class="cursor-pointer new-design-button reports">Reports<i
                        class="bi bi-chevron-double-down ms-2"></i></span>
            </div>
            <div>
                <span class="cursor-pointer new-design-button mx-1">Download Report <i
                        class="bi bi-cloud-download ms-1"></i></span>
                <span class="cursor-pointer new-design-button mx-1">Filter <i
                        class="bi bi-chevron-down ms-1"></i></span>
            </div>
        </div>
    </div>
</div>
{{!-- <div class="container-fluid reports-details-container mt-3">
    <div class="row">
        <div class="col">
            <span class="reports-details">
                <p>Total Stock value</p>
            </span>
        </div>
    </div>
</div> --}}

<div class="container-fluid px-md-4">
    <div class="row">
        <div class="col">
            <table class="mt-3 warehouse-table-container">
                <thead>
                    <tr>
                        <th scope="col px-2" class="text-truncate">Product name</th>
                        <th scope="col" class="text-truncate">Category</th>
                        <th scope="col" class="text-truncate">Rate</th>
                        <th scope="col" class="text-truncate">Min stock</th>
                        <th scope="col" class="text-truncate">Unit</th>
                    </tr>
                </thead>
                <tbody id="warehouse-table-body">
                </tbody>
            </table>
        </div>
    </div>
</div>

{{!-- ADD NEW ITEM MODAL --}}
<div class="add-new-item-modal hide px-md-0 px-1">
    <h4 class="font-weight-bold m-md-4 mx-md-5 mx-3 mt-4">Create new product</h4>
    <div class="product-info container">
        <form>
            <div class="row">
                <div class="col-lg-4 col-md-5 mt-5 ms-smd-5 mb-5 d-flex align-items-center flex-column">
                    <div class="product-img m-0">
                        <div>
                            <i class="bi bi-image-fill"></i>
                            <p>+ Choose product image</p>
                            <input hidden type="file" name="new-product-img" id="new-product-img"
                                accept="image/*,.jpg,.png,.jpeg">
                        </div>
                        <script>
                            $('#new-product-img').on('change', (e) => {
                                productImgSrc = URL.createObjectURL(event.target.files[0]);
                                $('.add-new-item-modal .product-img div').addClass('active').attr('style', `background:url('${productImgSrc}')`);
                                $('.add-new-item-modal .product-img div p').fadeOut(0)
                                $('.add-new-item-modal .product-img div i').fadeOut(0)
                                //ProductImgCmd("show",`${productImgSrc}`)
                            })
                        </script>
                    </div>
                    <p class="mb-0 mt-2 ms-2 font-weight-bold">Upload Product Image</p>
                </div>
                <div class="col-md-6 pb-5 pt-2" style="overflow-y: auto;">
                    <div class="form-group">
                        <label for="productName" class="font-weight-bold text-secondary">Product name</label>
                        <input required type="text" class="form-control shadow-none" name="productName" id="productName"
                            placeholder="enter your product name">
                    </div>
                    <div class="form-group">
                        <label for="categoryName" class="font-weight-bold text-secondary">Category</label>
                        <select class="form-select" name="categoryName">
                        </select>
                        <input type="text" class="form-control shadow-none newCategoryName" hidden
                            placeholder="name your category">
                        <h6 class="my-2 text-primary cursor-pointer user-select-none add-new-category-btn"
                            onclick="addNewCategory('add')">add new categrory</h6>
                        <script>
                            function addNewCategory(cmd) {
                                if (cmd == "add") {
                                    // add new category
                                    $('.add-new-item-modal .add-new-category-btn').html("Choose category").attr('onclick', 'addNewCategory("remove")')
                                    $('.add-new-item-modal select[name="categoryName"]').fadeOut(10);
                                    $('.add-new-item-modal .newCategoryName').attr({ 'hidden': false, 'required': true }).val('').attr('name', 'categoryName')
                                } else if (cmd == "remove") {
                                    // select category
                                    $('.add-new-item-modal .add-new-category-btn').html("add new categrory").attr('onclick', 'addNewCategory("add")')
                                    $('.add-new-item-modal select[name="categoryName"]').fadeIn(10);
                                    $('.add-new-item-modal .newCategoryName').attr({ 'hidden': true, 'required': false }).val('').removeAttr('name')
                                }
                            }
                        </script>
                    </div>
                    <div class="form-group">
                        <label for="rate" class="font-weight-bold text-secondary">Rate</label>
                        <div style="position: relative;">
                            <input required type="number" class="form-control shadow-none ps-4" name="rate" id="rate"
                                placeholder="enter your product price">
                            <i class="bi bi-currency-rupee input-icon-left"></i>
                        </div>
                    </div>
                    <div class="form-group d-flex justify-content-between flex-wrap">
                        <div class=" w-100">
                            <label for="minimumStock" class="font-weight-bold text-secondary">Min Stock</label>
                            <input required type="number" class="form-control shadow-none" name="minimumStock"
                                id="minimumStock" placeholder="enter minimum stock">
                        </div>
                        {{!-- <div class=" w-100 mt-md-0 mt-3">
                            <label for="productName" class="font-weight-bold text-secondary">Unit of measurement</label>
                            <input required type="number" class="form-control shadow-none rounded-0" name="maximumStock"
                                id="maximumStock" placeholder="enter maximum stock">
                        </div> --}}
                    </div>
                    <div class="form-group">
                        <label for="unit" class="font-weight-bold text-secondary">Unit of measurement</label>
                        <select class="form-select" name="unit" id="unit">
                            <option value="null">Select an option</option>
                            <option value="Unit">Unit</option>
                            <option value="Kgs">Kg</option>
                            <option value="Bundle">Bundle</option>
                        </select>
                    </div>
                    <div class="form-group sku-input">
                        <label for="SKU" class="font-weight-bold text-secondary">Stock keeping unit ( SKU )</label>
                        <div style="position: relative;">
                            <input required type="text" class="form-control shadow-none pr-5" name="SKU" id="SKU"
                                placeholder="enter product SKU">
                            <i class="bi bi-code-square input-icon-right cursor-pointer"
                                onclick="$(this).parent().children('input').val(generateSKU($('.add-new-item-modal form')))"
                                data-toggle="tooltip" data-html="true" title="Generate SKU"></i>
                        </div>
                    </div>
                    {{!-- <div class="form-group">
                        <label for="currentStock" class="font-weight-bold text-secondary">Current stock</label>
                        <input required type="text" class="form-control shadow-none" name="currentStock"
                            id="currentStock" placeholder="enter current stock">
                    </div> --}}
                    {{!-- <div class="form-group">
                        <label for="description" class="font-weight-bold text-secondary">Description</label>
                        <input type="text" class="form-control shadow-none" name="description" id="description"
                            placeholder="enter product description ( optional )">
                    </div> --}}
                    <div class="newProductFooterSec form-group justify-content-end mt-3 align-items-center flex-wrap"
                        style="display: flex;">
                        <p class="error text-danger mx-3 d-md-inline d-block m-0"></p>
                        <button class="btn bg-text-base-color shadow-none" type="submit">Register</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>


{{!-- CHECK IN / OUT MODAL --}}
<div class="modal checkInModal" id="checkInModal" tabindex="-1" role="dialog" aria-labelledby="checkInModal"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Check In ( Add stock)</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="">Date</label>
                        <input required type="text" class="form-control shadow-none" name="date"
                            placeholder="enter date">
                    </div>
                    <div class="form-group">
                        <label for="productName">Product name / SKU</label>
                        <div class="productName-cont" style="position: relative;">
                            <input required type="text" class="form-control shadow-none" id="productName"
                                onkeyup="printPNsuggestions('.product-name-suggestions','.checkInModal #productName')"
                                autocomplete="off" onblur="verifyProductName();" placeholder="enter product name">
                            <ul class="product-name-suggestions">
                            </ul>
                            <input type="text" class="productID" hidden>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="">Quantity</label>
                        <input required type="number" class="form-control shadow-none" name="quantity"
                            placeholder="enter product quantity">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn bg-text-base-color shadow-none">Save changes</button>
                </div>
            </form>
        </div>
    </div>
</div>
<script>
    // print product name suggestions
    //function printPNsuggestions(){
    //    axios.get(`/api/v1/warehouse/${warehouseID}/category/all`).then(res => {
    //    $('.bottom-right-section').html(bottomRightSectionHtml)
    //    if (res.data.success) {
    //        $('.top-header-middle .reports').fadeOut(0)
    //        tableHead.html(tableHeadHtml)
    //        printProducts(res.data.categories)
    //    }
    //})
    //}
</script>
<style>
    .checkInModal .product-name-suggestions {
        list-style: none;
        position: absolute;
        left: 0em;
        width: 100%;
        top: 2.4em;
        background-color: #fff;
        padding: 0;
        box-shadow: rgba(100, 100, 111, 0.2) 0px 7px 29px 0px;
    }

    .checkInModal .product-name-suggestions li {
        padding: 0.5em 0 0.5em 23px;
        cursor: pointer;
        border-bottom: 1px solid #f2f2f2;
    }

    .checkInModal .product-name-suggestions li:hover {
        background-color: #fafafa;
    }
</style>



{{!-- MORE OPTION FOR INVENTARY SIDE MENU --}}
{{!-- <header class="right-side-header" id="right-side-header">
    <i class="bi bi-list" id="header-toggle"></i>
</header> --}}
{{!-- <div class="right-side-l-navbar shadow bg-light" id="nav-bar">
    <nav class="nav">
        <div>
            <a href="javascript:void(0)" class="nav_logo" onclick="$('.right-side-l-navbar').removeClass('show')">
                Close ( esc )
            </a>
            <div class="nav_list">
                <a href="javascript:void(0)" class="nav_link">
                    <i class="bi bi-file-earmark-plus-fill nav_icon"></i>
                    <span class="nav_name">Check In</span>
                </a>
                <a href="javascript:void(0)" class="nav_link">
                    <i class="bi bi-file-earmark-minus-fill nav_icon"></i>
                    <span class="nav_name">Check Out</span>
                </a>
                <a href="javascript:void(0)" class="nav_link">
                    <i class="bi bi-graph-up nav_icon"></i>
                    <span class="nav_name">Reports</span>
                </a>
            </div>
        </div>
    </nav>
</div> --}}
{{!--
<style>
    @import url("https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap");

    :root {
        --header-height: 3rem;
        --nav-width: 68px;
        --first-color: #4723D9;
        --first-color-light: #AFA5D9;
        --white-color: #F7F6FB;
        --body-font: 'Nunito', sans-serif;
        --normal-font-size: 1rem;
        --z-fixed: 100
    }

    *,
    ::before,
    ::after {
        box-sizing: border-box
    }

    .right-side-header a {
        text-decoration: none
    }

    .right-side-header {
        width: 100%;
        height: var(--header-height);
        position: fixed;
        top: 0;
        left: 0;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 1rem;
        background-color: var(--white-color);
        z-index: var(--z-fixed);
        transition: .5s
    }


    .right-side-l-navbar {
        position: fixed;
        bottom: 0;
        right: -30%;
        width: var(--nav-width);
        height: 100vh;
        background-color: var(--first-color);
        padding: .5rem 1rem 0 0;
        transition: .5s;
        z-index: var(--z-fixed)
    }

    .right-side-l-navbar .nav {
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        overflow: hidden
    }

    .right-side-l-navbar .nav_logo,
    .right-side-l-navbar .nav_link {
        display: grid;
        grid-template-columns: max-content max-content;
        align-items: center;
        column-gap: 1rem;
        padding: .5rem 0 .5rem 1.5rem
    }

    .right-side-l-navbar .nav_logo {
        margin-bottom: 2rem;
    }

    .right-side-l-navbar .nav_link {
        position: relative;
        color: #888888;
        margin-bottom: 0.5rem;
        transition: .3s
    }

    .right-side-l-navbar .nav_link:hover {
        background-color: #26ABE2;
        color: white;
    }

    .right-side-l-navbar .nav_icon {
        font-size: 1.25rem
    }

    .show {
        right: 0
    }

    .body-pd {
        padding-left: calc(var(--nav-width) + 1rem)
    }

    .right-side-l-navbar.active {
        color: var(--white-color)
    }

    .right-side-l-navbar .active::before {
        content: '';
        position: absolute;
        left: 0;
        width: 2px;
        height: 32px;
        background-color: var(--white-color)
    }

    .right-side-l-navbar .height-100 {
        height: 100vh
    }

    @media screen and (min-width: 768px) {

        .right-side-header {
            height: calc(var(--header-height) + 1rem);
            padding: 0 2rem 0 calc(var(--nav-width) + 2rem)
        }

        .right-side-header .header_img {
            width: 40px;
            height: 40px
        }

        .right-side-header .header_img img {
            width: 45px
        }

        .right-side-l-navbar {
            right: -6.3em;
            padding: 1rem 1rem 0 0
        }

        .show {
            width: calc(var(--nav-width) + 222px)
        }

        .body-pd {
            padding-left: calc(var(--nav-width) + 188px)
        }
    }
</style> --}}
{{!-- BOTTOM RIGHT FIXED SECTION --}}
<div style="position: absolute;right:1em;bottom:1em" class="bottom-right-section">
    {{!-- <button class="btn bg-text-base-color shadow-none" onclick="$('.right-side-l-navbar').toggleClass('show')"><i
            class="bi bi-list"></i></button> --}}
    <button class="btn bg-text-base-color shadow-none" onclick="openNewItemModal()">Register Item</button>
</div>
{{/inline}}
{{#*inline "css"}}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
{{/inline}}
<script>
    warehouseID = `{{{warehouseID}}}`
</script>
<script src="/js/admin/warehouse/warehouse.js"></script>